<!-- Monta el contenedor animado solo cuando animReady === true (solo cliente) -->
<section class="reg-root" *ngIf="animReady()" [@page]>

  <header class="reg-header">
    <a class="brand" routerLink="/">
      <strong>NutriTrack</strong>
    </a>

    <a routerLink="/" class="back-link">
      <lucide-icon [img]="ArrowLeftIcon" aria-hidden="true"></lucide-icon>
      <span>Volver al inicio</span>
    </a>
  </header>

  <div class="container grid">
    <article class="card">
      <h1 class="title">Iniciar sesión</h1>
      <p class="sub">Accede con tu correo y contraseña.</p>

      <form [formGroup]="form" (ngSubmit)="submit()" novalidate>
        <div class="field">
          <label for="f-email">Correo</label>
          <div class="input">
            <span class="icon-left"><lucide-icon [img]="MailIcon" aria-hidden="true"></lucide-icon></span>
            <input id="f-email" type="email" formControlName="email" placeholder="mail@gmail.com" autocomplete="email" />
          </div>
          <small class="err" *ngIf="form.controls.email.touched && form.controls.email.invalid">Correo no válido.</small>
        </div>

        <div class="field">
          <label for="f-pass">Contraseña</label>
          <div class="input">
            <span class="icon-left"><lucide-icon [img]="LockIcon" aria-hidden="true"></lucide-icon></span>
            <input id="f-pass" type="password" formControlName="password" placeholder="••••••••" autocomplete="current-password" />
          </div>
          <small class="err" *ngIf="form.controls.password.touched && form.controls.password.invalid">Mínimo 6 caracteres.</small>
        </div>

        <div style="text-align:right; margin-top:0.25rem;">
          <a href="#" (click)="forgotPassword(); $event.preventDefault()">¿Olvidaste tu contraseña?</a>
        </div>

        <button class="btn btn-primary full" [disabled]="submitting()">
          {{ submitting() ? 'Accediendo…' : 'Entrar' }}
        </button>

        <div class="messages">
          <p class="err server" *ngIf="serverError()">{{ serverError() }}</p>
          <p class="success" *ngIf="successMessage()">{{ successMessage() }}</p>
        </div>
      </form>

      <p class="muted" style="margin-top:1rem; text-align:center;">
        ¿No tienes cuenta? <a routerLink="/register">Regístrate</a>
      </p>
    </article>

    <aside class="card visuals">
      <h2 class="aside-title">Bienvenido de vuelta</h2>
      <p class="aside-sub">Accede a tu perfil y sigue tu progreso de salud.</p>
    </aside>
  </div>
</section>
